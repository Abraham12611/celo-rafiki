/// <reference types="node" />
/** Client for an instance of the POPRF protocol interacting with a POPRF service. */
export declare class PoprfClient {
    readonly publicKey: Uint8Array;
    readonly tag: Uint8Array;
    readonly message: Uint8Array;
    readonly seed?: Uint8Array | undefined;
    /** Blinded message to be sent to the POPRF service for evaluation */
    readonly blindedMessage: Buffer;
    /** Secret blinding factor used for blinding and response verification. */
    protected readonly blindingFactor: Buffer;
    /**
     * Constructs POPRF client state, blinding the given message and saving the public key, blinding
     * factor, and tag for use in verification and unbinding of the response.
     *
     * @remarks Note that this client represents the client-side of a single protocol exchange.
     *
     * @param publicKey Public key for the POPRF service for use in verification.
     * @param tag A plaintext tag which will be sent to the service along with the message.
     * @param message A plaintext message which you want to blind and send to the POPRF service.
     * @param seed Seed for the blinding factor. Provided if deterministic blinding is needed.
     *   Note that, by design, if the same seed and message is used twice, the blinded message will be
     *   the same. This allows for linking between the two blinded messages and so only should be used
     *   if this is intended (e.g. to provide for retries of requests without consuming quota).
     */
    constructor(publicKey: Uint8Array, tag: Uint8Array, message: Uint8Array, seed?: Uint8Array | undefined);
    /**
     * Given a blinded evaluation response, unblind and verify the evaluation, returning the result.
     *
     * @remarks Note that this function expects a complete/aggregated response, and not a partial
     * response as is returned by an individual server in a threshold service implementation. If the
     * client wishes to unblind and verify partial responses, they will need to use the
     * ThresholdPoprfClient.
     *
     * @param response A blinded evaluation response.
     * @returns a buffer with the final POPRF output.
     *
     * @throws If the given response is invalid or cannot be verified against the public key, tag, and
     * blinding state present in this client.
     */
    unblindResponse(response: Uint8Array): Buffer;
}
/**
 * Combiner for an instance of the POPRF protocol acting as a relayer between the client and
 * threshold service operators. A combiner effectively combines a set of service operators to appear
 * as a single service.
 *
 * @remarks In the Pith POPRF protocol, verification occurs as part of the unblinding process and
 * therefore only the client and determine is a given response is valid. As a result, the combiner
 * cannot determine whether the responses from the service as correct, as long as they are
 * well-formed.
 */
export declare class PoprfCombiner {
    readonly threshold: number;
    constructor(threshold: number);
    /**
     * If there are enough responses provided, aggregates the collection of blind partial evaluations
     * to a single blind threshold evaluation.
     *
     * @param response An array of blinded partial evaluation responses.
     * @remarks Does not verify any of the responses. Verification only occurs during unblinding.
     *
     * @returns A buffer with a blind aggregated POPRF evaluation response, or undefined if there are
     * less than the threshold number of responses provided.
     */
    blindAggregate(blindedResponses: Uint8Array[]): Buffer | undefined;
    /**
     * If there are enough responses provided, aggregates the collection of partial evaluations
     * to a single POPRF evaluation.
     *
     * @param response An array of partial evaluation responses.
     * @returns A buffer with a POPRF evaluation, or undefined if there are less than the threshold
     * number of responses provided.
     */
    aggregate(responses: Uint8Array[]): Buffer | undefined;
}
/**
 * Client for interacting with a threshold implementation of the POPRF service without a combiner.
 *
 * @privateRemarks
 * TODO Combine this class with the functionality from the combiner to create a POPRF client
 * that can handle expunging bad partial evaluations from a set of responses.
 */
export declare class ThresholdPoprfClient extends PoprfClient {
    readonly publicKey: Uint8Array;
    readonly polynomial: Uint8Array;
    readonly tag: Uint8Array;
    readonly message: Uint8Array;
    readonly seed?: Uint8Array | undefined;
    /**
     * Constructs POPRF client state, blinding the given message and saving the public keys, blinding
     * factor, and tag for use in verification and unbinding of the response.
     *
     * Note that this client represents the client-side of a single protocol exchange.
     *
     * @param publicKey Public key for the POPRF service for use in verification.
     * @param polynomial Public key polynomial for the individual POPRF servers for use in verification.
     * @param tag A plaintext tag which will be sent to the service along with the message.
     * @param message A plaintext message which you want to blind and send to the POPRF service.
     * @param seed Seed for the blinding factor. Provided if deterministic blinding is needed.
     *   Note that, by design, if the same seed and message is used twice, the blinded message will be
     *   the same. This allows for linking between the two blinded messages and so only should be used
     *   if this is intended (e.g. to provide for retries of requests without consuming quota).
     */
    constructor(publicKey: Uint8Array, polynomial: Uint8Array, tag: Uint8Array, message: Uint8Array, seed?: Uint8Array | undefined);
    /**
     * Given a blinded partial evaluation response, unblind and verify the evaluation share, returning the result.
     *
     * @param response A blinded partial evaluation response.
     * @returns a buffer with unblinded partial evaluation.
     *
     * @throws If the given response is invalid or cannot be verified against the public key, tag, and
     * blinding state present in this client.
     */
    unblindPartialResponse(response: Uint8Array): Buffer;
}
/**
 * Server for the POPRF protocol for answering queries from clients.
 *
 * @remarks Note that, unlike the client, the server object is stateless and may be used for
 * multiple protocol exchanges, including being used concurrently.
 */
export declare class PoprfServer {
    readonly privateKey: Uint8Array;
    constructor(privateKey: Uint8Array);
    /**
     * Evaluates the POPRF function over the tag and blinded message with the (complete) private key
     *
     * @param tag plaintext tag buffer to be combined with the blinded message in the POPRF.
     *
     * @returns a serialized blinded evaluation response.
     */
    blindEval(tag: Uint8Array, blindedMessage: Uint8Array): Buffer;
}
/**
 * Server for a threshold implementation of the POPRF protocol for answering queries from clients.
 *
 * @remarks Note that, unlike the client, the server object is stateless and may be used for
 * multiple protocol exchanges, including being used concurrently.
 */
export declare class ThresholdPoprfServer {
    readonly privateKeyShare: Uint8Array;
    constructor(privateKeyShare: Uint8Array);
    /**
     * Evaluates the POPRF function over the tag and blinded message with the private key share.
     *
     * @param tag plaintext tag buffer to be combined with the blinded message in the POPRF.
     *
     * @returns a serialized blinded partial evaluation response.
     */
    blindPartialEval(tag: Uint8Array, blindedMessage: Uint8Array): Buffer;
}

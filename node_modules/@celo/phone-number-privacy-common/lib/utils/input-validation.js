"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasValidBlindedPhoneNumberParam = exports.isBodyReasonablySized = exports.hasValidAccountParam = void 0;
const address_1 = require("@celo/utils/lib/address");
const is_base64_1 = __importDefault(require("is-base64"));
const constants_1 = require("./constants");
function hasValidAccountParam(requestBody) {
    return !!requestBody.account && (0, address_1.isValidAddress)(requestBody.account);
}
exports.hasValidAccountParam = hasValidAccountParam;
function isBodyReasonablySized(requestBody) {
    return JSON.stringify(requestBody).length <= constants_1.REASONABLE_BODY_CHAR_LIMIT;
}
exports.isBodyReasonablySized = isBodyReasonablySized;
function hasValidBlindedPhoneNumberParam(requestBody) {
    return (!!requestBody.blindedQueryPhoneNumber &&
        requestBody.blindedQueryPhoneNumber.length === 64 &&
        (0, is_base64_1.default)(requestBody.blindedQueryPhoneNumber));
}
exports.hasValidBlindedPhoneNumberParam = hasValidBlindedPhoneNumberParam;

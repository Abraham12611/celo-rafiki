import { ContractKit } from '@celo/contractkit';
import Logger from 'bunyan';
import { Request } from 'express';
import { ErrorType, PhoneNumberPrivacyRequest } from '../interfaces';
export type DataEncryptionKeyFetcher = (address: string) => Promise<string>;
export declare function newContractKitFetcher(contractKit: ContractKit, logger: Logger, fullNodeTimeoutMs?: number, fullNodeRetryCount?: number, fullNodeRetryDelayMs?: number): DataEncryptionKeyFetcher;
export declare function authenticateUser<R extends PhoneNumberPrivacyRequest>(request: Request<{}, {}, R>, logger: Logger, fetchDEK: DataEncryptionKeyFetcher, warnings?: ErrorType[]): Promise<boolean>;
export declare function getMessageDigest(message: string): string;
export declare function signWithRawKey(msg: string, rawKey: string): string;
export declare function verifyDEKSignature(message: string, messageSignature: string, registeredEncryptionKey: string, logger?: Logger): boolean;
export declare function getDataEncryptionKey(address: string, contractKit: ContractKit, logger: Logger, fullNodeTimeoutMs: number, fullNodeRetryCount: number, fullNodeRetryDelayMs: number): Promise<string>;
